(iproblems
Problem
p0
(dp1
S'time_limit'
p2
(lp3
VTime Limit: 2 sec
p4
asS'source_limit'
p5
(lp6
VSource Limit: 50000 Bytes
p7
asS'description'
p8
V All submissions for this problem are available.\u000aRead problems statements in Russian here\u000aThe Head Chef has a reporting hierarchy for his chefs which is basically a binary tree i.e. Each chef reports to exactly one chef and every chef can take reporting of atmost two chefs . In case two chefs report to the same chef they must report at different times . The time of reporting can have only two values : Morning or Evening ( denoted by M and E , respectively ) .The Head Chef himself is not part of the reporting structure . The Head Chef has found that a new restaurant in Byteland is opening and it is hiring a group of chefs from some existing restaurant . The new restaurant will basically make an offer to one of the chefs and all the chefs directly or indirectly reporting to the chef . The Head Chef is worried that the new restaurant may be taking away some of his chefs . The Head Chef knows that the new restaurant will not change the reporting structure of the chefs . The Head Chef also has access to the reporting structure of the new restaurant in terms of ages of Chefs . The Head Chef wants to know whether there is a need to worry or not . He needs to worry if the new restaurant can possibly be targetting his chefs .\u000aIn short given a tree T and another tree O you need to tell whether O is a subtree of T or not . The node values of T or O need not be distinct as they represent the age of the Chef . Also , a subtree of a rooted tree includes a particular node and the entire tree structure below it .\u000aTwo trees A and B are considered same if age(A->root ) = age(B->root) and subtree rooted at A->left is same as subtree rooted at B->left and subtree rooted at A->right is same as subtree rooted B->right .\u000aInput\u000aThe first line of the input contains an integer N denoting the number of chefs in Head Chef's restaurant. The Chefs are denoted by number 1 to N .\u000aThe next N lines contain ages of the chefs with the i th line containing the age of chef i .\u000aThe next N - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where A denotes the senior chef and B denotes the reporting chef , and the character C denotes the time of reporting .\u000aThe next line of the input contains an integer Q denoting the number of queries/possible structures of chefs of new restaurant . This is followed by description of Q queries .\u000aThe first line of each query contains an integer M denoting the number of chefs in new restaurant. The Chefs are denoted by numbers 1 to M.\u000aThe next M lines contain the ages of the chefs with the i th line denoting the age of chef i .\u000aThe next M - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where B denotes the reporting chef and A denotes the chef who takes the reporting , and the character C denotes the time of reporting .\u000aOutput\u000aFor each test case answer "YES" or "NO" as applicable .\u000aConstraints\u000a2 \u2264 N \u2264 100000\u000a1 \u2264 M \u2264 1000\u000a1 \u2264 Q \u2264 200\u000a1 \u2264 Age of Chef \u2264 100\u000aExample\u000aInput:\u000a5\u000a1\u000a2\u000a1\u000a2\u000a1\u000a1 2 M\u000a1 3 E\u000a2 4 E\u000a3 5 M\u000a2\u000a2\u000a1\u000a2\u000a1 2 M\u000a2\u000a1\u000a1\u000a1 2 M\u000aOutput:\u000aNO\u000aYES\u000a  Author: vineetpaliwal\u000aTester: rubanenko\u000aEditorial: http://discuss.codechef.com/problems/TRSUBTR\u000aTags: cook40 hashing kmp medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC\u000aSUBMIT All submissions for this problem are available.\u000aRead problems statements in Russian here\u000aThe Head Chef has a reporting hierarchy for his chefs which is basically a binary tree i.e. Each chef reports to exactly one chef and every chef can take reporting of atmost two chefs . In case two chefs report to the same chef they must report at different times . The time of reporting can have only two values : Morning or Evening ( denoted by M and E , respectively ) .The Head Chef himself is not part of the reporting structure . The Head Chef has found that a new restaurant in Byteland is opening and it is hiring a group of chefs from some existing restaurant . The new restaurant will basically make an offer to one of the chefs and all the chefs directly or indirectly reporting to the chef . The Head Chef is worried that the new restaurant may be taking away some of his chefs . The Head Chef knows that the new restaurant will not change the reporting structure of the chefs . The Head Chef also has access to the reporting structure of the new restaurant in terms of ages of Chefs . The Head Chef wants to know whether there is a need to worry or not . He needs to worry if the new restaurant can possibly be targetting his chefs .\u000aIn short given a tree T and another tree O you need to tell whether O is a subtree of T or not . The node values of T or O need not be distinct as they represent the age of the Chef . Also , a subtree of a rooted tree includes a particular node and the entire tree structure below it .\u000aTwo trees A and B are considered same if age(A->root ) = age(B->root) and subtree rooted at A->left is same as subtree rooted at B->left and subtree rooted at A->right is same as subtree rooted B->right .\u000aInput\u000aThe first line of the input contains an integer N denoting the number of chefs in Head Chef's restaurant. The Chefs are denoted by number 1 to N .\u000aThe next N lines contain ages of the chefs with the i th line containing the age of chef i .\u000aThe next N - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where A denotes the senior chef and B denotes the reporting chef , and the character C denotes the time of reporting .\u000aThe next line of the input contains an integer Q denoting the number of queries/possible structures of chefs of new restaurant . This is followed by description of Q queries .\u000aThe first line of each query contains an integer M denoting the number of chefs in new restaurant. The Chefs are denoted by numbers 1 to M.\u000aThe next M lines contain the ages of the chefs with the i th line denoting the age of chef i .\u000aThe next M - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where B denotes the reporting chef and A denotes the chef who takes the reporting , and the character C denotes the time of reporting .\u000aOutput\u000aFor each test case answer "YES" or "NO" as applicable .\u000aConstraints\u000a2 \u2264 N \u2264 100000\u000a1 \u2264 M \u2264 1000\u000a1 \u2264 Q \u2264 200\u000a1 \u2264 Age of Chef \u2264 100\u000aExample\u000aInput:\u000a5\u000a1\u000a2\u000a1\u000a2\u000a1\u000a1 2 M\u000a1 3 E\u000a2 4 E\u000a3 5 M\u000a2\u000a2\u000a1\u000a2\u000a1 2 M\u000a2\u000a1\u000a1\u000a1 2 M\u000aOutput:\u000aNO\u000aYES\u000a  Author: vineetpaliwal\u000aTester: rubanenko\u000aEditorial: http://discuss.codechef.com/problems/TRSUBTR\u000aTags: cook40 hashing kmp medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC All submissions for this problem are available. Read problems statements in Russian here here The Head Chef has a reporting hierarchy for his chefs which is basically a binary tree i.e. Each chef reports to exactly one chef and every chef can take reporting of atmost two chefs . In case two chefs report to the same chef they must report at different times . The time of reporting can have only two values : Morning or Evening ( denoted by M and E , respectively ) .The Head Chef himself is not part of the reporting structure . The Head Chef has found that a new restaurant in Byteland is opening and it is hiring a group of chefs from some existing restaurant . The new restaurant will basically make an offer to one of the chefs and all the chefs directly or indirectly reporting to the chef . The Head Chef is worried that the new restaurant may be taking away some of his chefs . The Head Chef knows that the new restaurant will not change the reporting structure of the chefs . The Head Chef also has access to the reporting structure of the new restaurant in terms of ages of Chefs . The Head Chef wants to know whether there is a need to worry or not . He needs to worry if the new restaurant can possibly be targetting his chefs . In short given a tree T and another tree O you need to tell whether O is a subtree of T or not . The node values of T or O need not be distinct as they represent the age of the Chef . Also , a subtree of a rooted tree includes a particular node and the entire tree structure below it . T O O T T O Two trees A and B are considered same if age(A->root ) = age(B->root) and subtree rooted at A->left is same as subtree rooted at B->left and subtree rooted at A->right is same as subtree rooted B->right . Input The first line of the input contains an integer N denoting the number of chefs in Head Chef's restaurant. The Chefs are denoted by number 1 to N .\u000aThe next N lines contain ages of the chefs with the i th line containing the age of chef i .\u000aThe next N - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where A denotes the senior chef and B denotes the reporting chef , and the character C denotes the time of reporting .\u000aThe next line of the input contains an integer Q denoting the number of queries/possible structures of chefs of new restaurant . This is followed by description of Q queries .\u000aThe first line of each query contains an integer M denoting the number of chefs in new restaurant. The Chefs are denoted by numbers 1 to M.\u000aThe next M lines contain the ages of the chefs with the i th line denoting the age of chef i .\u000aThe next M - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where B denotes the reporting chef and A denotes the chef who takes the reporting , and the character C denotes the time of reporting . The first line of the input contains an integer N denoting the number of chefs in Head Chef's restaurant. The Chefs are denoted by number 1 to N . N 1 N The next N lines contain ages of the chefs with the i th line containing the age of chef i . N i i The next N - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where A denotes the senior chef and B denotes the reporting chef , and the character C denotes the time of reporting . N - 1 A B C 'M' 'E' A B C The next line of the input contains an integer Q denoting the number of queries/possible structures of chefs of new restaurant . This is followed by description of Q queries . Q Q The first line of each query contains an integer M denoting the number of chefs in new restaurant. The Chefs are denoted by numbers 1 to M. M 1 M The next M lines contain the ages of the chefs with the i th line denoting the age of chef i . M i i The next M - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where B denotes the reporting chef and A denotes the chef who takes the reporting , and the character C denotes the time of reporting . M - 1 A B C 'M' 'E' B A C Output For each test case answer "YES" or "NO" as applicable . Constraints 2 \u2264 N \u2264 100000\u000a1 \u2264 M \u2264 1000\u000a1 \u2264 Q \u2264 200\u000a1 \u2264 Age of Chef \u2264 100 2 \u2264 N \u2264 100000 2 N 100000 1 \u2264 M \u2264 1000 1 M 1000 1 \u2264 Q \u2264 200 1 Q 200 1 \u2264 Age of Chef \u2264 100 1 Age of Chef 100 Example Input:\u000a5\u000a1\u000a2\u000a1\u000a2\u000a1\u000a1 2 M\u000a1 3 E\u000a2 4 E\u000a3 5 M\u000a2\u000a2\u000a1\u000a2\u000a1 2 M\u000a2\u000a1\u000a1\u000a1 2 M\u000aOutput:\u000aNO\u000aYES Input: Output:    Author: vineetpaliwal\u000aTester: rubanenko\u000aEditorial: http://discuss.codechef.com/problems/TRSUBTR\u000aTags: cook40 hashing kmp medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: vineetpaliwal\u000aTester: rubanenko\u000aEditorial: http://discuss.codechef.com/problems/TRSUBTR\u000aTags: cook40 hashing kmp medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: vineetpaliwal Author: vineetpaliwal vineetpaliwal Tester: rubanenko Tester: rubanenko rubanenko Editorial: http://discuss.codechef.com/problems/TRSUBTR Editorial: http://discuss.codechef.com/problems/TRSUBTR http://discuss.codechef.com/problems/TRSUBTR Tags: cook40 hashing kmp medium vineetpaliwal Tags: cook40 hashing kmp medium vineetpaliwal cook40 hashing kmp medium vineetpaliwal Date Added: 28-10-2013 Date Added: 28-10-2013 Time Limit: 2 sec Time Limit: 2 sec Source Limit: 50000 Bytes Source Limit: 50000 Bytes Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC SUBMIT  SUBMIT SUBMIT SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS  
p9
sS'tags'
p10
V cook40 hashing kmp medium vineetpaliwal
p11
sS'url'
p12
Vhttps://www.codechef.com/problems/TRSUBTR
p13
sS'statement'
p14
(lp15
VAll submissions for this problem are available.
p16
aVRead problems statements in Russian here
p17
aVThe Head Chef has a reporting hierarchy for his chefs which is basically a binary tree i.e. Each chef reports to exactly one chef and every chef can take reporting of atmost two chefs . In case two chefs report to the same chef they must report at different times . The time of reporting can have only two values : Morning or Evening ( denoted by M and E , respectively ) .The Head Chef himself is not part of the reporting structure . The Head Chef has found that a new restaurant in Byteland is opening and it is hiring a group of chefs from some existing restaurant . The new restaurant will basically make an offer to one of the chefs and all the chefs directly or indirectly reporting to the chef . The Head Chef is worried that the new restaurant may be taking away some of his chefs . The Head Chef knows that the new restaurant will not change the reporting structure of the chefs . The Head Chef also has access to the reporting structure of the new restaurant in terms of ages of Chefs . The Head Chef wants to know whether there is a need to worry or not . He needs to worry if the new restaurant can possibly be targetting his chefs .
p18
aVIn short given a tree T and another tree O you need to tell whether O is a subtree of T or not . The node values of T or O need not be distinct as they represent the age of the Chef . Also , a subtree of a rooted tree includes a particular node and the entire tree structure below it .
p19
aVTwo trees A and B are considered same if age(A->root ) = age(B->root) and subtree rooted at A->left is same as subtree rooted at B->left and subtree rooted at A->right is same as subtree rooted B->right .
p20
asS'input'
p21
(lp22
VInput
p23
aVThe first line of the input contains an integer N denoting the number of chefs in Head Chef's restaurant. The Chefs are denoted by number 1 to N .
p24
aVThe next N lines contain ages of the chefs with the i th line containing the age of chef i .
p25
aVThe next N - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where A denotes the senior chef and B denotes the reporting chef , and the character C denotes the time of reporting .
p26
aVThe next line of the input contains an integer Q denoting the number of queries/possible structures of chefs of new restaurant . This is followed by description of Q queries .
p27
aVThe first line of each query contains an integer M denoting the number of chefs in new restaurant. The Chefs are denoted by numbers 1 to M.
p28
aVThe next M lines contain the ages of the chefs with the i th line denoting the age of chef i .
p29
aVThe next M - 1 lines contain two integers A and B and a character C which is either 'M' or 'E' where B denotes the reporting chef and A denotes the chef who takes the reporting , and the character C denotes the time of reporting .
p30
aVOutput
p31
aVFor each test case answer "YES" or "NO" as applicable .
p32
asS'constraints'
p33
(lp34
VConstraints
p35
aV2 \u2264 N \u2264 100000
p36
aV1 \u2264 M \u2264 1000
p37
aV1 \u2264 Q \u2264 200
p38
aV1 \u2264 Age of Chef \u2264 100
p39
asS'id'
p40
c__builtin__
id
p41
sS'name'
p42
VTRSUBTR
p43
sb.