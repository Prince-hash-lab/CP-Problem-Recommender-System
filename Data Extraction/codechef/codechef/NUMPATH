(iproblems
Problem
p0
(dp1
S'time_limit'
p2
(lp3
VTime Limit: 0.5 sec
p4
asS'source_limit'
p5
(lp6
VSource Limit: 50000 Bytes
p7
asS'description'
p8
V All submissions for this problem are available.\u000aRead problems statements in Russian here\u000aThe Head Chef is interested in studying interactions between his chefs . There are N chefs with ids 1 to N . Each chef trusts some of the other chefs . The relation of trust is one way . Also , a chef may trust chefs only with ids strictly greater than his/her id .A chef with id = i , trusts the chefs with next ni id's.\u000aThe Head Chef wants to know given a chef B and a set of chefs S, how many lines of trust exist between each element of S and B . A line of trust between chefs A and B is a sequence of chefs a1 ... ak starting at A ( a1 = A )and finishing at B (Ak = B) such that Ai trusts A(i+1) for all i ( 1 to k-1) . Two lines of trust are different if they have a different chef at the some position in the line .\u000a\u000a\u000aSince the answer may be quite large , output it modulo 1000000007 .\u000aInput\u000aThe first line contains a two space seperated integers N and B denoting the number of chefs and the target chef for whom the lines of trust have to be calculated.\u000aThe next N lines contains an integer ni denoting the number of chefs which are trusted by the chef with id = i .\u000aThe next line contains a single integer Q denoting the number of queries\u000aThe next Q lines contain elements of set S .\u000aOutput\u000aOutput a single line for each query containing the answer to the query.\u000aConstraints\u000a1 \u2264 N \u2264 200000\u000a1 \u2264 B \u2264 N\u000a1 \u2264 Q \u2264 100000\u000a1 \u2264 Each element of set S < B\u000a1 \u2264 i + ni ( for i = 1 to N ) \u2264 N\u000a0 \u2264 ni ( for i = 1 to N ) \u2264 N - 1\u000aExample\u000aInput:\u000a3 3\u000a2\u000a1\u000a0\u000a2\u000a1\u000a2\u000aOutput:\u000a2\u000a1\u000aExplanation\u000aExample case 1. The lines of trust between 1 and 3 are\u000a\u000a1 , 3\u000a\u000a1 , 2 ,3\u000a\u000aThere is one line of trust between 2 and 3 which is\u000a\u000a2 3\u000aAuthor: vineetpaliwal\u000aEditorial: http://discuss.codechef.com/problems/NUMPATH\u000aTags: cook40 dynamic-prog fenwick medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 0.5 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC\u000aSUBMIT All submissions for this problem are available.\u000aRead problems statements in Russian here\u000aThe Head Chef is interested in studying interactions between his chefs . There are N chefs with ids 1 to N . Each chef trusts some of the other chefs . The relation of trust is one way . Also , a chef may trust chefs only with ids strictly greater than his/her id .A chef with id = i , trusts the chefs with next ni id's.\u000aThe Head Chef wants to know given a chef B and a set of chefs S, how many lines of trust exist between each element of S and B . A line of trust between chefs A and B is a sequence of chefs a1 ... ak starting at A ( a1 = A )and finishing at B (Ak = B) such that Ai trusts A(i+1) for all i ( 1 to k-1) . Two lines of trust are different if they have a different chef at the some position in the line .\u000a\u000a\u000aSince the answer may be quite large , output it modulo 1000000007 .\u000aInput\u000aThe first line contains a two space seperated integers N and B denoting the number of chefs and the target chef for whom the lines of trust have to be calculated.\u000aThe next N lines contains an integer ni denoting the number of chefs which are trusted by the chef with id = i .\u000aThe next line contains a single integer Q denoting the number of queries\u000aThe next Q lines contain elements of set S .\u000aOutput\u000aOutput a single line for each query containing the answer to the query.\u000aConstraints\u000a1 \u2264 N \u2264 200000\u000a1 \u2264 B \u2264 N\u000a1 \u2264 Q \u2264 100000\u000a1 \u2264 Each element of set S < B\u000a1 \u2264 i + ni ( for i = 1 to N ) \u2264 N\u000a0 \u2264 ni ( for i = 1 to N ) \u2264 N - 1\u000aExample\u000aInput:\u000a3 3\u000a2\u000a1\u000a0\u000a2\u000a1\u000a2\u000aOutput:\u000a2\u000a1\u000aExplanation\u000aExample case 1. The lines of trust between 1 and 3 are\u000a\u000a1 , 3\u000a\u000a1 , 2 ,3\u000a\u000aThere is one line of trust between 2 and 3 which is\u000a\u000a2 3\u000aAuthor: vineetpaliwal\u000aEditorial: http://discuss.codechef.com/problems/NUMPATH\u000aTags: cook40 dynamic-prog fenwick medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 0.5 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC All submissions for this problem are available. Read problems statements in Russian here here The Head Chef is interested in studying interactions between his chefs . There are N chefs with ids 1 to N . Each chef trusts some of the other chefs . The relation of trust is one way . Also , a chef may trust chefs only with ids strictly greater than his/her id .A chef with id = i , trusts the chefs with next ni id's. N i  The Head Chef wants to know given a chef B and a set of chefs S, how many lines of trust exist between each element of S and B . A line of trust between chefs A and B is a sequence of chefs a1 ... ak starting at A ( a1 = A )and finishing at B (Ak = B) such that Ai trusts A(i+1) for all i ( 1 to k-1) . Two lines of trust are different if they have a different chef at the some position in the line . 1 k 1 k i (i+1) Since the answer may be quite large , output it modulo 1000000007 .   Input The first line contains a two space seperated integers N and B denoting the number of chefs and the target chef for whom the lines of trust have to be calculated.\u000aThe next N lines contains an integer ni denoting the number of chefs which are trusted by the chef with id = i .\u000aThe next line contains a single integer Q denoting the number of queries\u000aThe next Q lines contain elements of set S . The first line contains a two space seperated integers N and B denoting the number of chefs and the target chef for whom the lines of trust have to be calculated. N B The next N lines contains an integer ni denoting the number of chefs which are trusted by the chef with id = i . N ni i The next line contains a single integer Q denoting the number of queries Q The next Q lines contain elements of set S . Q S Output Output a single line for each query containing the answer to the query. Output a single line for each query containing the answer to the query. Constraints 1 \u2264 N \u2264 200000\u000a1 \u2264 B \u2264 N\u000a1 \u2264 Q \u2264 100000\u000a1 \u2264 Each element of set S < B\u000a1 \u2264 i + ni ( for i = 1 to N ) \u2264 N\u000a0 \u2264 ni ( for i = 1 to N ) \u2264 N - 1 1 \u2264 N \u2264 200000 1 N 200000 1 \u2264 B \u2264 N 1 B N 1 \u2264 Q \u2264 100000 1 Q 100000 1 \u2264 Each element of set S < B 1 Each element of set S B 1 \u2264 i + ni ( for i = 1 to N ) \u2264 N 1 i + ni ( for i = 1 to N ) i N 0 \u2264 ni ( for i = 1 to N ) \u2264 N - 1 0 ni ( for i = 1 to N ) i N - 1 Example Input:\u000a3 3\u000a2\u000a1\u000a0\u000a2\u000a1\u000a2\u000aOutput:\u000a2\u000a1 Input: Output: Explanation Example case 1. The lines of trust between 1 and 3 are\u000a\u000a1 , 3\u000a\u000a1 , 2 ,3\u000a\u000aThere is one line of trust between 2 and 3 which is\u000a\u000a2 3 Example case 1.           Author: vineetpaliwal\u000aEditorial: http://discuss.codechef.com/problems/NUMPATH\u000aTags: cook40 dynamic-prog fenwick medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 0.5 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: vineetpaliwal\u000aEditorial: http://discuss.codechef.com/problems/NUMPATH\u000aTags: cook40 dynamic-prog fenwick medium vineetpaliwal\u000aDate Added: 28-10-2013\u000aTime Limit: 0.5 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: vineetpaliwal Author: vineetpaliwal vineetpaliwal Editorial: http://discuss.codechef.com/problems/NUMPATH Editorial: http://discuss.codechef.com/problems/NUMPATH http://discuss.codechef.com/problems/NUMPATH Tags: cook40 dynamic-prog fenwick medium vineetpaliwal Tags: cook40 dynamic-prog fenwick medium vineetpaliwal cook40 dynamic-prog fenwick medium vineetpaliwal Date Added: 28-10-2013 Date Added: 28-10-2013 Time Limit: 0.5 sec Time Limit: 0.5 sec Source Limit: 50000 Bytes Source Limit: 50000 Bytes Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC SUBMIT  SUBMIT SUBMIT SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS  
p9
sS'tags'
p10
V cook40 dynamic-prog fenwick medium vineetpaliwal
p11
sS'url'
p12
Vhttps://www.codechef.com/problems/NUMPATH
p13
sS'statement'
p14
(lp15
VAll submissions for this problem are available.
p16
aVRead problems statements in Russian here
p17
aVThe Head Chef is interested in studying interactions between his chefs . There are N chefs with ids 1 to N . Each chef trusts some of the other chefs . The relation of trust is one way . Also , a chef may trust chefs only with ids strictly greater than his/her id .A chef with id = i , trusts the chefs with next ni id's.
p18
aVThe Head Chef wants to know given a chef B and a set of chefs S, how many lines of trust exist between each element of S and B . A line of trust between chefs A and B is a sequence of chefs a1 ... ak starting at A ( a1 = A )and finishing at B (Ak = B) such that Ai trusts A(i+1) for all i ( 1 to k-1) . Two lines of trust are different if they have a different chef at the some position in the line .
p19
aV
p20
ag20
aVSince the answer may be quite large , output it modulo 1000000007 .
p21
asS'input'
p22
(lp23
VInput
p24
aVThe first line contains a two space seperated integers N and B denoting the number of chefs and the target chef for whom the lines of trust have to be calculated.
p25
aVThe next N lines contains an integer ni denoting the number of chefs which are trusted by the chef with id = i .
p26
aVThe next line contains a single integer Q denoting the number of queries
p27
aVThe next Q lines contain elements of set S .
p28
aVOutput
p29
aVOutput a single line for each query containing the answer to the query.
p30
asS'constraints'
p31
(lp32
VConstraints
p33
aV1 \u2264 N \u2264 200000
p34
aV1 \u2264 B \u2264 N
p35
aV1 \u2264 Q \u2264 100000
p36
aV1 \u2264 Each element of set S < B
p37
aV1 \u2264 i + ni ( for i = 1 to N ) \u2264 N
p38
aV0 \u2264 ni ( for i = 1 to N ) \u2264 N - 1
p39
asS'id'
p40
c__builtin__
id
p41
sS'name'
p42
VNUMPATH
p43
sb.