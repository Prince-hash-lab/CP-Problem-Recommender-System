(iproblems
Problem
p0
(dp1
S'time_limit'
p2
(lp3
VTime Limit: 2 sec
p4
asS'source_limit'
p5
(lp6
VSource Limit: 50000 Bytes
p7
asS'description'
p8
V All submissions for this problem are available.\u000aRead problems statements in Mandarin Chinese and Russian.\u000aChef had a hard time arguing with his friend, and after getting a great old kick Chef saw a colored array with N cells, numbered from 1 to N.\u000aThe kick was so strong that Chef suddenly understood the rules of the game.\u000aEach cell is painted with a color. Here the colors are numbered from 1 to M.\u000aFor any cell i, Chef can repaint it with any color q, and the cost of such operation is Ci,q points.\u000aHowever Chef can do at most K repaintings (0 repaintings is possible).\u000aAfter performing all repaintings, each cell will have some color. For each cell i, if cell i has color q then Chef will receive Bi,q points.\u000aNow Chef is wondering how many points can he receive in total when he repaints optimally.\u000aInput\u000aThe first line of the input contains an integer T, denoting the number of test cases. The description of T test cases follows.\u000aThe first line of each test case contains three space-separated integers N, M and K, denoting the number of cells and the number of colors, the maximal possible number of repaintings respectively. The next line contains N space-separated integers A1, A2, ..., AN, denoting the initial colors of the cells. Then N lines follow. The ith line of them contains M integers Bi1, Bi2, ..., BiM, where Bij denotes how many points Chef will receive if the cell i will be painted with j-th color after all operations. Then N lines follow. The ith line of them contains M integers Ci1, Ci2, ..., CiM, where Cij denotes how many points Chef will lose if he repaints the cell i with color j.\u000aNote: Be careful that the size of input files can be large.\u000aOutput\u000aFor each test case, output a single line containing the maximal possible points.\u000aConstraints\u000a1 \u2264 T \u2264 5\u000a0 \u2264 K \u2264 1000\u000a1 \u2264 N, M \u2264 1000\u000a1 \u2264 Ai \u2264 M\u000a0 \u2264 Bi,j \u2264 1000\u000a0 \u2264 Ci,j \u2264 1000\u000aIf j = Ai, then Ci,j = 0\u000aExample\u000aInput:\u000a1\u000a4 2 1\u000a1 1 2 2\u000a1 1\u000a1 1\u000a1 1\u000a3 1\u000a0 1\u000a0 1\u000a1 0\u000a1 0\u000a\u000aOutput:\u000a5\u000aExplanation:\u000aFor this sample, we can repaint only once, since K = 1. We should repaint 4th cell with color 1. We will pay 1 for this, and receive:\u000a1 (1st cell - 1st color) +\u000a\u000a1 (2nd cell -1st color) +\u000a\u000a1 (3rd cell - 2nd color) +\u000a\u000a3 (4th cell - 1st color) = 6.\u000aHence we get 6 \u2212 1 = 5 points in total, and it is the optimal answer.\u000aAuthor: berezin\u000aTester: gerald\u000aEditorial: http://discuss.codechef.com/problems/COLARR\u000aTags: berezin easy feb14\u000aDate Added: 7-01-2014\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC\u000aSUBMIT All submissions for this problem are available.\u000aRead problems statements in Mandarin Chinese and Russian.\u000aChef had a hard time arguing with his friend, and after getting a great old kick Chef saw a colored array with N cells, numbered from 1 to N.\u000aThe kick was so strong that Chef suddenly understood the rules of the game.\u000aEach cell is painted with a color. Here the colors are numbered from 1 to M.\u000aFor any cell i, Chef can repaint it with any color q, and the cost of such operation is Ci,q points.\u000aHowever Chef can do at most K repaintings (0 repaintings is possible).\u000aAfter performing all repaintings, each cell will have some color. For each cell i, if cell i has color q then Chef will receive Bi,q points.\u000aNow Chef is wondering how many points can he receive in total when he repaints optimally.\u000aInput\u000aThe first line of the input contains an integer T, denoting the number of test cases. The description of T test cases follows.\u000aThe first line of each test case contains three space-separated integers N, M and K, denoting the number of cells and the number of colors, the maximal possible number of repaintings respectively. The next line contains N space-separated integers A1, A2, ..., AN, denoting the initial colors of the cells. Then N lines follow. The ith line of them contains M integers Bi1, Bi2, ..., BiM, where Bij denotes how many points Chef will receive if the cell i will be painted with j-th color after all operations. Then N lines follow. The ith line of them contains M integers Ci1, Ci2, ..., CiM, where Cij denotes how many points Chef will lose if he repaints the cell i with color j.\u000aNote: Be careful that the size of input files can be large.\u000aOutput\u000aFor each test case, output a single line containing the maximal possible points.\u000aConstraints\u000a1 \u2264 T \u2264 5\u000a0 \u2264 K \u2264 1000\u000a1 \u2264 N, M \u2264 1000\u000a1 \u2264 Ai \u2264 M\u000a0 \u2264 Bi,j \u2264 1000\u000a0 \u2264 Ci,j \u2264 1000\u000aIf j = Ai, then Ci,j = 0\u000aExample\u000aInput:\u000a1\u000a4 2 1\u000a1 1 2 2\u000a1 1\u000a1 1\u000a1 1\u000a3 1\u000a0 1\u000a0 1\u000a1 0\u000a1 0\u000a\u000aOutput:\u000a5\u000aExplanation:\u000aFor this sample, we can repaint only once, since K = 1. We should repaint 4th cell with color 1. We will pay 1 for this, and receive:\u000a1 (1st cell - 1st color) +\u000a\u000a1 (2nd cell -1st color) +\u000a\u000a1 (3rd cell - 2nd color) +\u000a\u000a3 (4th cell - 1st color) = 6.\u000aHence we get 6 \u2212 1 = 5 points in total, and it is the optimal answer.\u000aAuthor: berezin\u000aTester: gerald\u000aEditorial: http://discuss.codechef.com/problems/COLARR\u000aTags: berezin easy feb14\u000aDate Added: 7-01-2014\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC All submissions for this problem are available. Read problems statements in Mandarin Chinese and Russian. Mandarin Chinese Russian Chef had a hard time arguing with his friend, and after getting a great old kick Chef saw a colored array with N cells, numbered from 1 to N. N 1 N The kick was so strong that Chef suddenly understood the rules of the game. Each cell is painted with a color. Here the colors are numbered from 1 to M.\u000aFor any cell i, Chef can repaint it with any color q, and the cost of such operation is Ci,q points.\u000aHowever Chef can do at most K repaintings (0 repaintings is possible).\u000aAfter performing all repaintings, each cell will have some color. For each cell i, if cell i has color q then Chef will receive Bi,q points. Each cell is painted with a color. Here the colors are numbered from 1 to M. 1 M For any cell i, Chef can repaint it with any color q, and the cost of such operation is Ci,q points. i q Ci,q i,q However Chef can do at most K repaintings (0 repaintings is possible). K 0 After performing all repaintings, each cell will have some color. For each cell i, if cell i has color q then Chef will receive Bi,q points. i i q Bi,q i,q Now Chef is wondering how many points can he receive in total when he repaints optimally. Input The first line of the input contains an integer T, denoting the number of test cases. The description of T test cases follows. T T The first line of each test case contains three space-separated integers N, M and K, denoting the number of cells and the number of colors, the maximal possible number of repaintings respectively. The next line contains N space-separated integers A1, A2, ..., AN, denoting the initial colors of the cells. Then N lines follow. The ith line of them contains M integers Bi1, Bi2, ..., BiM, where Bij denotes how many points Chef will receive if the cell i will be painted with j-th color after all operations. Then N lines follow. The ith line of them contains M integers Ci1, Ci2, ..., CiM, where Cij denotes how many points Chef will lose if he repaints the cell i with color j. N M K N A1 1 A2 2 AN N N i th M Bi1 i 1 Bi2 i 2 BiM i M Bij ij i j N i th M Ci1 i 1 Ci2 i 2 CiM i M Cij ij i j Note: Be careful that the size of input files can be large. Note: Output For each test case, output a single line containing the maximal possible points. Constraints 1 \u2264 T \u2264 5\u000a0 \u2264 K \u2264 1000\u000a1 \u2264 N, M \u2264 1000\u000a1 \u2264 Ai \u2264 M\u000a0 \u2264 Bi,j \u2264 1000\u000a0 \u2264 Ci,j \u2264 1000\u000aIf j = Ai, then Ci,j = 0 1 \u2264 T \u2264 5 1 \u2264 T \u2264 5 0 \u2264 K \u2264 1000 0 \u2264 K \u2264 1000 1 \u2264 N, M \u2264 1000 1 \u2264 N, M \u2264 1000 1 \u2264 Ai \u2264 M 1 \u2264 Ai \u2264 M i 0 \u2264 Bi,j \u2264 1000 0 \u2264 Bi,j \u2264 1000 i,j 0 \u2264 Ci,j \u2264 1000 0 \u2264 Ci,j \u2264 1000 i,j If j = Ai, then Ci,j = 0 j = Ai i Ci,j = 0 i,j Example Input:\u000a1\u000a4 2 1\u000a1 1 2 2\u000a1 1\u000a1 1\u000a1 1\u000a3 1\u000a0 1\u000a0 1\u000a1 0\u000a1 0\u000a\u000aOutput:\u000a5 Input: Output: Explanation: Explanation: For this sample, we can repaint only once, since K = 1. We should repaint 4th cell with color 1. We will pay 1 for this, and receive: K = 1 4 th 1 1 1 (1st cell - 1st color) +\u000a\u000a1 (2nd cell -1st color) +\u000a\u000a1 (3rd cell - 2nd color) +\u000a\u000a3 (4th cell - 1st color) = 6. 1 1 st 1 st   1 2 nd 1 st   1 3 rd 2 nd   3 4 th 1 st 6 Hence we get 6 \u2212 1 = 5 points in total, and it is the optimal answer. 6 \u2212 1 = 5  Author: berezin\u000aTester: gerald\u000aEditorial: http://discuss.codechef.com/problems/COLARR\u000aTags: berezin easy feb14\u000aDate Added: 7-01-2014\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: berezin\u000aTester: gerald\u000aEditorial: http://discuss.codechef.com/problems/COLARR\u000aTags: berezin easy feb14\u000aDate Added: 7-01-2014\u000aTime Limit: 2 sec\u000aSource Limit: 50000 Bytes\u000aLanguages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Author: berezin Author: berezin berezin Tester: gerald Tester: gerald gerald Editorial: http://discuss.codechef.com/problems/COLARR Editorial: http://discuss.codechef.com/problems/COLARR http://discuss.codechef.com/problems/COLARR Tags: berezin easy feb14 Tags: berezin easy feb14 berezin easy feb14 Date Added: 7-01-2014 Date Added: 7-01-2014 Time Limit: 2 sec Time Limit: 2 sec Source Limit: 50000 Bytes Source Limit: 50000 Bytes Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC Languages: ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC SUBMIT  SUBMIT SUBMIT SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS SUCCESSFUL SUBMISSIONS  
p9
sS'tags'
p10
V berezin easy feb14
p11
sS'url'
p12
Vhttps://www.codechef.com/problems/COLARR
p13
sS'statement'
p14
(lp15
VAll submissions for this problem are available.
p16
aVRead problems statements in Mandarin Chinese and Russian.
p17
aVChef had a hard time arguing with his friend, and after getting a great old kick Chef saw a colored array with N cells, numbered from 1 to N.
p18
aVThe kick was so strong that Chef suddenly understood the rules of the game.
p19
aVEach cell is painted with a color. Here the colors are numbered from 1 to M.
p20
aVFor any cell i, Chef can repaint it with any color q, and the cost of such operation is Ci,q points.
p21
aVHowever Chef can do at most K repaintings (0 repaintings is possible).
p22
aVAfter performing all repaintings, each cell will have some color. For each cell i, if cell i has color q then Chef will receive Bi,q points.
p23
aVNow Chef is wondering how many points can he receive in total when he repaints optimally.
p24
asS'input'
p25
(lp26
VInput
p27
aVThe first line of the input contains an integer T, denoting the number of test cases. The description of T test cases follows.
p28
aVThe first line of each test case contains three space-separated integers N, M and K, denoting the number of cells and the number of colors, the maximal possible number of repaintings respectively. The next line contains N space-separated integers A1, A2, ..., AN, denoting the initial colors of the cells. Then N lines follow. The ith line of them contains M integers Bi1, Bi2, ..., BiM, where Bij denotes how many points Chef will receive if the cell i will be painted with j-th color after all operations. Then N lines follow. The ith line of them contains M integers Ci1, Ci2, ..., CiM, where Cij denotes how many points Chef will lose if he repaints the cell i with color j.
p29
aVNote: Be careful that the size of input files can be large.
p30
aVOutput
p31
aVFor each test case, output a single line containing the maximal possible points.
p32
asS'constraints'
p33
(lp34
VConstraints
p35
aV1 \u2264 T \u2264 5
p36
aV0 \u2264 K \u2264 1000
p37
aV1 \u2264 N, M \u2264 1000
p38
aV1 \u2264 Ai \u2264 M
p39
aV0 \u2264 Bi,j \u2264 1000
p40
aV0 \u2264 Ci,j \u2264 1000
p41
aVIf j = Ai, then Ci,j = 0
p42
asS'id'
p43
c__builtin__
id
p44
sS'name'
p45
VCOLARR
p46
sb.